FROM node:14-alpine

USER root

WORKDIR /frontend

# GET ARGS
ARG VUE_APP_BASE_API
ARG VUE_APP_JITSI_SCRIPT_URL
ARG VUE_APP_JITSI_DOMAIN_URL
# AND EXPORT THEN
ENV VUE_APP_BASE_API=${VUE_APP_BASE_API}
ENV VUE_APP_JITSI_SCRIPT_URL=${VUE_APP_JITSI_SCRIPT_URL}
ENV VUE_APP_JITSI_DOMAIN_URL=${VUE_APP_JITSI_DOMAIN_URL}

COPY package.json .
RUN apk add git && npm install
COPY . /frontend
RUN npm run build:prod